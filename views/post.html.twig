{% extends "base.html.twig" %}

{% block title %}{{ post.title }}{% endblock %}


{% block body %}
    <div class="post-main-container">
        <h2>{{ post.title }}</h2>

        <div class="post-container">
            <p class="author">Publié par {{ post.author }} le {{ post.createDate|date('d m Y') }}</p>
            <p class="date">Mis à jour le {{ post.updateDate|date('d m Y') }}</p>
            <text class="summary">{{ post.summary }}</text>
            <text class="content">{{ post.content }}</text>
        </div>

        {% if message %}
            <div class="message-container">
                {% if message starts with 'Erreur:' %}
                    <div class="error">
                        <p class="message">{{ message }}</p>
                    </div>
                {% else %}
                    <div class="confirm">
                        <p class="message">{{ message }}</p>
                    </div>
                {% endif %}
            </div>
        {% endif %}

        <div class="comment-container">
            <h3>Laisser un commentaire</h3>
            {% if session.user is not defined %}
                <p>Si vous souhaitez laisser un commentaire, vous devez vous <a href="/login">connecter</a></p>
            {% else %}
                <div class="form-container">
                    <form method="post" action="/comment">
                        <div class="textarea-container">
                            <textarea id="content" name="content" placeholder="Commentaire" required="required"></textarea>
                            <label for="content"></label>
                        </div>
                        <input type="hidden" id="postId" name="postId" value="{{ post.id }}">

                        <div class="submit-container">
                            <input class="submit" type="submit" value="Commenter" />
                        </div>
                    </form>
                </div>
            {% endif %}

            {% for comment in comments %}
                <div class="comment">
                    <p>{{ comment.author.username }}</p>
                    <p>{{ comment.date|date('d m Y') }}</p>
                    <textarea>{{ comment.content }}</textarea>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}